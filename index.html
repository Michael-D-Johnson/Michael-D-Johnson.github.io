<!DOCTYPE html>
<html>
<head>
<title>
Chart 1
</title>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
</head>
<body>
<center>
<div class="toplinks">  
    <a href="https://michael-d-johnson.github.io/about">Description</a>
</div>
<div id="viz" width="600" height="600"></div>
<div id="tooltip"></div>
<input type="button" onclick="location.href='https://michael-d-johnson.github.io/next_scene';" value="Next" style="float:right"/>
</center>
<style>
#tooltip {
    opacity: 0;
    position: absolute;
    text-align: center;
    width: 75px; height: 20px;
    background: white;
    border: 0px;
    color: black;
}
</style>
<script>
    // Source: https://www.kdnuggets.com/2018/03/simple-bar-chart-d3.html
    var tooltip = d3.select("#tooltip");

    //set the margin of the SVG
    var margin = {top: 50, right: 100, bottom: 50, left: 100}

    //set the width and height using the current width and height of the SVG
    var width = 600 - margin.left - margin.right;
    var height = 600 - margin.top - margin.bottom;
    
    var svg = d3.select("#viz").append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height",height + margin.top + margin.bottom)
                .append("g")
                .attr("transform",
                      "translate(" + margin.left + "," + margin.top + ")");

    var colors = ["darkgray","blue"];

    var x = d3.scaleBand()
        .range([0,width]);
    var y = d3.scaleLinear()
        .range([height,0]);

    d3.csv("static/all_natl_data.filtered.totalcostsal.csv", function(error,data) {
        if (error) throw error;
            console.log(data[0]); 

            //format the data
            data.forEach(function(d) {
                d.YEAR = +d.YEAR;
                d.TOTALCOST = +d.TOTALCOST
                d.TOTSAL = +d.TOTSAL;
            });
        
            x.domain(data.map(function(d) { return d.YEAR;}));
            y.domain([0,d3.max(data,function(d) {return d.TOTALCOST;})]);

        svg.append("path")
        .datum(data[1])
        .attr("class","line1")
        .attr("fill", "none")
        .attr("stroke", "orange")
        .attr("stroke-linejoin", "round")
        .attr("stroke-linecap", "round")
        .attr("stroke-width", 1.5)
        .attr("d", d3.line()
            .x(function(d) {return x(d.YEAR);})
            .y(function(d) {return x(d.TOTALCOST);}))
        .on("mouseover",function(d){
            tooltip.style("opacity",1)
                   .style("left",(d3.event.pageX)+"px")
                   .style("top",(d3.event.pageY)+"px")
                   .html(+d.TOTALCOST);
                    d3.select(this).attr("stroke-width",3)})
        .on("mouseout",function() { tooltip.style("opacity",0);
                                    d3.select(this).attr("stroke-width", 1.5)})

        //svg.append("path")
        //.datum(data[0])
        //.attr("class","line2")
        //.attr("fill", "none")
        //.attr("stroke", "steelblue")
        //.attr("stroke-linejoin", "round")
        //.attr("stroke-linecap", "round")
        //.attr("stroke-width", 1.5)
        //.attr("d", d3.line()
         //   .x(function(d) {return x(d.YEAR);})
          //  .y(function(d) {return x(d.TOTALCOST);}))
        //.on("mouseover",function(d){
         //   tooltip.style("opacity",1)
         //          .style("left",(d3.event.pageX)+"px")
         //          .style("top",(d3.event.pageY)+"px")
         //          .html(+d.TOTALCOST);
         //           d3.select(this).attr("stroke-width",3)})
        //.on("mouseout",function() { tooltip.style("opacity",0);
         //                           d3.select(this).attr("stroke-width", 1.5)})

        svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x));
        
        svg.append("g")
        .call(d3.axisLeft(y));

        // add labels
        svg.append("text")
        .attr("x", (width / 2))             
        .attr("y", 0 - (margin.top / 2))
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .style("text-decoration", "underline")  
        .text("Average Total Cost of Housing per Year");

        svg.append("text")
        .attr("transform", "rotate(-90)")
        .attr("x", 0 - (height / 2))
        .attr("y",0 - 50)
        .style("text-anchor", "middle")
        .text("Average Total Cost of Housing (USD)");

        svg.append("text")
        .attr("class", "x label")
        .attr("text-anchor", "middle")
        .attr("x", width/2 )
        .attr("y", height + margin.bottom)
        .text("Year");

        });
</script>
</body>
</html>
